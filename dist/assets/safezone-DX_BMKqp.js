import{a as d,b as y}from"./item-CGP0yRqd.js";import{loadGame as b}from"./loadGame-CCfekxrt.js";if(!location.pathname.includes("/"))throw console.warn("safezone.ts は index.html 上でのみ実行される想定です"),new Error("safezone.ts を中断します");const s=document.getElementById("lobby"),p=document.getElementById("select-player-area"),u=document.getElementById("shop-area"),g=document.getElementById("cooking-area"),B=document.getElementById("cooking-btn"),w=document.querySelectorAll(".safety-area-btn"),k=document.getElementById("shop-btn"),v=document.getElementById("prepare-battle-btn");v.addEventListener("click",()=>{s.style.display="none",p.style.display="block"});w.forEach(e=>{e.addEventListener("click",()=>{s.style.display="block",p.style.display="none",u.style.display="none",g.style.display="none"})});k.addEventListener("click",()=>{u.style.display="block",s.style.display="none"});B.addEventListener("click",()=>{s.style.display="none",g.style.display="block"});document.getElementById("start-button-buttle").addEventListener("click",async()=>{const e=document.getElementById("alert-msg"),t=document.getElementById("player-name-input").value.trim();if(t.length<1||t.length>8){e.textContent="名前は１文字以上、もしくは8文字以内に設定してください";return}if(!/^[ぁ-んァ-ン一-龥a-zA-Z0-9ー]+$/.test(t)){e.textContent="使用できない文字が含まれています（日本語・英数字のみ可）";return}const n=await b(t);if(n){const o={name:n.name,equipment:n.equipment??[],items:n.inventory??[]};localStorage.setItem("playerData",JSON.stringify(o)),console.log(`[LOAD OK] ${t} のセーブデータで開始`)}else{const o=f.map(a=>({...d[a],amount:1})),i=E.map(a=>({...y[a],amount:1})),l={name:t,equipment:o,items:i};localStorage.setItem("playerData",JSON.stringify(l)),console.log(`[NEW PLAYER] ${t} を新規作成`)}window.location.href="battleDisplay.html"});const f=[],E=[],L=document.getElementById("equipment-options"),A=document.getElementById("heal-item-options"),q=d.filter(e=>e.rarity==="common"),D=y.filter(e=>e.rarity==="common");I(q,L,f,2);I(D,A,E,2);function I(e,t,n,o){e.forEach((i,l)=>{const a=document.createElement("button");a.textContent=i.name,a.addEventListener("click",()=>{const m=n.indexOf(l);if(m!==-1)n.splice(m,1),a.classList.remove("selected-class");else{if(n.length>=o){alert(`最大${o}つまで選べます`);return}n.push(l),a.classList.add("selected-class")}}),t.appendChild(a)})}const h=document.getElementById("loading-area"),r=document.getElementById("loading-tittle"),c={show(e){r.animate([{opacity:0,transform:"translateY(-10rem)"},{opacity:1,transform:"translateY(0)"}],{duration:1e3,easing:"ease",fill:"forwards"}).onfinish=()=>{e()}},loading(e){let t=0;const n=setInterval(()=>{if(t+=3,t>100){clearInterval(n),e();return}const o=`linear-gradient(to right, red 0%, red ${t}%, #a5a5a5 ${t}%, #a5a5a5 100%)`;r.style.backgroundImage=o},50)},end(){r.animate([{opacity:1,transform:"translateY(0)"},{opacity:0,transform:"translateY(10rem)"}],{duration:1e3,easing:"ease",fill:"forwards"}),setTimeout(()=>{h.animate({opacity:[1,0],visibility:"hidden"},{duration:1e3,easing:"ease",fill:"forwards"})},500);const e=document.getElementById("main-content");e.style.display="block"}};async function S(){try{await new Promise(e=>c.show(e)),await new Promise(e=>c.loading(e)),await new Promise(e=>setTimeout(e,500))}catch(e){console.error("データの読み込みに失敗しました:",e)}finally{c.end()}}document.addEventListener("DOMContentLoaded",()=>{h.style.display="flex",S()});
