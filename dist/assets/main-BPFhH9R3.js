var Be=Object.defineProperty;var be=(e,t,n)=>t in e?Be(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var i=(e,t,n)=>be(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();let H=null,S=null;const Q=document.getElementById("tittle-log"),ue=document.getElementById("next-stage"),E=document.getElementById("background-area");function de(e){Q.innerHTML+=`<h3>
 ${e}</h3>`}function f(e="",t=""){const s=ue.style.display!=="none"?S:H;s&&(e&&(s.innerHTML+=`<p>
<strong>${e}</strong></p>`,E.innerHTML+=`<p>
${e}</p>`),t&&(s.innerHTML+=`<p>
<strong>${t}</strong></p>`,E.innerHTML+=`<p>
${t}</p>`),s.scrollTo({top:s.scrollHeight,behavior:"smooth"}),console.log(s))}function r(e,t=""){const s=ue.style.display!=="none"?S:H;s&&(e&&(s.innerHTML+=`<p>
<strong>${e}</strong></p>`,E.innerHTML+=`<p>
${e}</p>`),t&&(s.innerHTML+=`<p>
<strong>${t}</strong></p>`,E.innerHTML+=`<p>
${t}</p>`),E.scrollTo({top:E.scrollHeight,behavior:"smooth"}))}function ye(){H&&(H.innerHTML=""),S&&(S.innerHTML=""),Q.innerHTML=""}function he(){H&&(H.innerHTML=""),S&&(S.innerHTML=""),E.innerHTML="",Q.innerHTML=""}function Pe({battleLog:e,afterBattleLog:t}){H=e,S=t}const ke=[{className:"æˆ¦å£«",hp:130,mp:30,physicalStrength:50,magicalStrength:15,defense:25,speed:20},{className:"é­”æ³•ä½¿ã„",hp:80,mp:80,physicalStrength:15,magicalStrength:50,defense:20,speed:25}],k=[{name:"ã‚¹ãƒ©ã‚¤ãƒ ",className:"monster",hp:100,mp:0,physicalStrength:40,magicalStrength:0,defense:15,speed:20},{name:"ã‚´ãƒ–ãƒªãƒ³",className:"monster",hp:120,mp:30,physicalStrength:50,magicalStrength:10,defense:20,speed:20},{name:"ã‚ªãƒ¼ã‚¯",className:"monster",hp:150,mp:35,physicalStrength:60,magicalStrength:15,defense:30,speed:20},{name:"ãƒªãƒƒãƒ",className:"monster",hp:300,mp:200,physicalStrength:70,magicalStrength:100,defense:18,speed:50},{name:"ãƒ‰ãƒ©ã‚´ãƒ³",className:"monster",hp:500,mp:200,physicalStrength:80,magicalStrength:70,defense:80,speed:50},{name:"ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ãƒœã‚¹",className:"monster",hp:1e3,mp:500,physicalStrength:100,magicalStrength:100,defense:100,speed:20}],A=document.getElementById("instruction-border"),ve=document.getElementById("instruction");function y({playerStatus:e,enemyStatus:t,healItemsDiv:n,equipItemsDiv:s,equippedDiv:a}=d){const o=g();let l;if(o instanceof Object&&"inventory"in o)l=o;else return;const u=v();e.textContent=l.getPlayerStatus(),t.textContent=u.getEnemyStatus(),n.innerHTML="",s.innerHTML="";let $=!1,b=!1;l.inventory.forEach(c=>{if(c.amount<=0)return;const p=document.createElement("button");p.textContent=`${c.showAmount()}`,p.addEventListener("mouseenter",()=>{A.style.display="block",ve.innerText=c.instructionText}),p.addEventListener("mouseleave",()=>{A.style.display="none"}),p.addEventListener("click",()=>{if(A.style.display="none",["hpHeal","mpHeal","bothHeal"].includes(c.itemType)){if(c.itemType==="hpHeal"&&l.hp===l.maxHp)return f("HPãŒMAXãªãŸã‚ã€è–¬ã¯ä½¿ç”¨ä¸å¯");if(c.itemType==="mpHeal"&&l.mp===l.maxMp)return f("MPãŒMAXãªãŸã‚ã€è–¬ã¯ä½¿ç”¨ä¸å¯");l.healItem(c)}else c.itemType==="equipment"&&(l.equipItem(c),c.isEquipped=!0);if(c.amount--,c.amount<=0){const I=l.inventory.indexOf(c);l.inventory.splice(I,1)}y(d)}),["hpHeal","mpHeal","bothHeal"].includes(c.itemType)?(n.appendChild(p),$=!0,n.style.color="black"):c.itemType==="equipment"&&(s.appendChild(p),b=!0,s.style.color="black")}),$||(n.innerText="ä½•ã‚‚æŒã£ã¦ã„ãªã„",n.style.color="gray",n.style.textAlign="center"),b||(s.innerText="ä½•ã‚‚æŒã£ã¦ã„ãªã„",s.style.color="gray",s.style.textAlign="center"),a.innerHTML=`<h3>è£…å‚™ä¸­ã‚¢ã‚¤ãƒ†ãƒ </h3>
`,l.equipment.length>0?l.equipment.forEach(c=>{const p=document.createElement("button");let I="";c.effect.physicalStrength&&(I+=` æ”»æ’ƒ+${c.effect.physicalStrength}`),c.effect.defense&&(I+=` é˜²å¾¡+${c.effect.defense}`),p.textContent=`${c.name}${I}ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§å¤–ã™ï¼‰`,p.style.cursor="pointer",p.addEventListener("click",()=>{l.unequipItem(c),y(d)}),a.appendChild(p)}):a.innerHTML+="<p>æœªè£…å‚™</p>"}const V=[{name:"ã‚¹ãƒ©ãƒƒã‚·ãƒ¥",mpCost:5,type:"attack",power:e=>Math.floor(e.magicalStrength*1.3),log:(e,t,n,s)=>{n.hp<=0?(n.hp=0,r(`${n.name} ã¯ã€ç´°åˆ‡ã‚Œã«ã•ã‚ŒãŸ`,`${n.name} ã¯å€’ã‚ŒãŸï¼`)):r(`${t.name} ã¯ã€${e}ã€‘ã§æ”»æ’ƒï¼ ${n.name} ã« ${s} ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼`,`(${n.name}ã®HPï¼š${n.hp})`)},Instruction:`åç§°ï¼šã‚¹ãƒ©ãƒƒã‚·ãƒ¥
 å°‘ã—ã®ã‚ªãƒ¼ãƒ©ã‚’çºã£ãŸæ–¬æ’ƒã‚’æ”¾ã¤ã€‚ãƒ€ãƒ¡ãƒ¼ã‚¸ã¯ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ç‰©ç†æ”»æ’ƒã«ä¾å­˜ã™ã‚‹`},{name:"ãƒ•ã‚¡ã‚¤ã‚¢ãƒœãƒ¼ãƒ«",mpCost:10,type:"attack",power:e=>Math.floor(e.magicalStrength*1.3),log:(e,t,n,s)=>{n.hp<=0?(n.hp=0,r(`${n.name}ã¯ã€ç‚­ç«ç„¼ãã«ã•ã‚ŒãŸ
 ${n.name} ã¯å€’ã‚ŒãŸï¼`)):r(`${t.name} ã¯ ã€${e}ã€‘ã§æ”»æ’ƒï¼ ${n.name} ã« ${s} ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼`,` (${n.name}ã®HPï¼š${n.hp})`)},Instruction:`åç§°ï¼šãƒ•ã‚¡ã‚¤ãƒ¤ãƒ¼ãƒœãƒ¼ãƒ«
 ç‚ã®çƒã‚’ç¹°ã‚Šå‡ºã™ã€‚ãƒ€ãƒ¡ãƒ¼ã‚¸ã¯ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ç²¾ç¥åŠ›ã«ä¾å­˜ã™ã‚‹`},{name:"ã‚¢ã‚¤ã‚¹ãƒ©ãƒ³ã‚¹",mpCost:12,type:"attack",power:e=>Math.floor(e.magicalStrength*1.5),log:(e,t,n,s)=>{n.hp<=0?(n.hp=0,r(`${n.name}ã¯ã€ä¸²åˆºã®ä¸­ã€å‡ãˆæ­»ã‚“ã ... `,`${n.name} ã¯å€’ã‚ŒãŸï¼`)):r(`${t.name} ã¯ã€${e}ã€‘ã§æ”»æ’ƒï¼ ${n.name} ã« ${s} ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼`,` (${n.name}ã®HPï¼š${n.hp})`)},Instruction:`åç§°ï¼šã‚¢ã‚¤ã‚¹ãƒ©ãƒ³ã‚¹
 æ°·ã®æ§ã‚’ç¹°ã‚Šå‡ºã™ã€‚ãƒ€ãƒ¡ãƒ¼ã‚¸ã¯ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã® ç²¾ç¥åŠ›Ã—1.5 ã«ä¾å­˜ã™ã‚‹`},{name:"è‡ªå·±å†ç”Ÿ",mpCost:8,type:"heal",element:"heal",power:()=>0,log:(e,t)=>{if(t.hp!==t.maxHp){const n=Math.floor(t.magicalStrength*1.5);t.hp=Math.min(t.maxHp,t.hp+n),r(`${t.name} ã¯ ${e} ã§HPã‚’${n}å›å¾©ï¼(${t.name}ã®HPï¼š${t.hp})`)}else r(`${t.name} ã®HPã¯æ—¢ã« MAX ã§ã™ï¼`)},Instruction:`åç§°ï¼šè‡ªå·±å†ç”Ÿ
 è‡ªã‚‰ã®åŠ›ã§ä½“åŠ›ã‚’å›å¾©ã™ã‚‹ã‚¹ã‚­ãƒ«ã€‚ç²¾ç¥åŠ›ä¾å­˜`}],qe=[{name:"ãƒ•ã‚¡ã‚¤ã‚¢ãƒ–ãƒ©ã‚¹ãƒˆ",mpCost:18,type:"attack",element:"fire",power:e=>Math.floor(e.magicalStrength*1.8),log:(e,t,n,s)=>{n.hp<=0?(n.hp=0,r(`${t.name} ã¯ ã€${e}ã€‘ã§çˆ†æ•£ã—ãŸ`,` ${n.name} ã¯å€’ã‚ŒãŸï¼`)):r(`${t.name} ã®ã€ãƒ•ã‚¡ã‚¤ã‚¢ãƒ–ãƒ©ã‚¹ãƒˆã€‘ãŒç‚¸è£‚ï¼`,`${n.name} ã« ${s} ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼(ç¾åœ¨ã®HPï¼š${n.hp})`)},Instruction:`åç§°ï¼šãƒ•ã‚¡ã‚¤ãƒ¤ãƒ–ãƒ©ã‚¹ãƒˆ
 ãƒ€ãƒ¡ãƒ¼ã‚¸ã¯ç²¾ç¥åŠ›ã«ä¾å­˜ã™ã‚‹å¼·åŠ›é­”æ³•`}],we=[{name:"æ¬¡å…ƒæ–¬",mpCost:35,type:"attack",element:"sword",power:e=>Math.floor(e.physicalStrength*2),log:(e,t,n,s)=>{n.hp<=0?(n.hp=0,r(`${n.name}ã¯ã€æ¬¡å…ƒã®ç‹­é–“ã«è‘¬ã‚Šå»ã‚‰ã‚ŒãŸ`,` ${n.name} ã¯å€’ã‚ŒãŸï¼`)):r(`${t.name} ã¯ã€${e}ã€‘ã§åˆ‡ã‚Šåˆ»ã¾ã‚Œã‚‹ï¼ ${n.name} ã« ${s} ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼ (${n.name}ã®HPï¼š${n.hp})`)},Instruction:`åç§°ï¼šæ¬¡å…ƒæ–¬
 é«˜å¨åŠ›ã®ç‰©ç†æ”»æ’ƒã€‚ç‰©ç†ã‚¹ãƒ†ä¾å­˜`},{name:"ã‚¤ãƒ³ãƒ•ã‚§ãƒ«ãƒ",mpCost:50,type:"attack",element:"fire",power:e=>Math.floor(e.magicalStrength*2.5),log:(e,t,n,s)=>{n.hp<=0?(n.hp=0,r(`${n.name}ã¯ã€æ¥­ç«ã«åŒ…ã¾ã‚Œã€æ¯ãŸãˆãŸ
 ${n.name} ã¯å€’ã‚ŒãŸï¼`)):r(`${t.name} ã®ã€${e}ã€‘ãŒå¤§åœ°ã‚’ç„¼ãå°½ãã™`,`${n.name} ã« ${s} ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼ (ç¾åœ¨ã®HPï¼š${n.hp})`)},Instruction:`åç§°ï¼šã‚¤ãƒ³ãƒ•ã‚§ãƒ«ãƒ
 fire elementã®æœ€çµ‚é€²åŒ–ç³»ã€‚ç²¾ç¥åŠ›ä¾å­˜`},{name:"ã‚¢ã‚¤ã‚¹ãƒ†ãƒ³ãƒšã‚¹ãƒˆ",mpCost:50,type:"attack",element:"ice",power:e=>Math.floor(e.magicalStrength*2.5),log:(e,t,n,s)=>{n.hp<=0?(n.hp=0,r(`${n.name}ã¯ã€æ°·æ¼¬ã‘ã«ã•ã‚ŒãŸ`,`${n.name} ã¯å€’ã‚ŒãŸï¼`)):r(`${t.name} ã®ã€${e}ã€‘ãŒéŠ€ä¸–ç•Œã‚’å‰µã‚Šå‡ºã™`,`${n.name} ã« ${s} ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼(${n.name}ã®HPï¼š${n.hp})`)},Instruction:`åç§°ï¼šã‚¢ã‚¤ã‚¹ãƒ†ãƒ³ãƒšã‚¹ãƒˆ
 æ°·å±æ€§ã®æœ€çµ‚é€²åŒ–ã‚¹ã‚­ãƒ«ã€‚ç²¾ç¥åŠ›ä¾å­˜`}],Ae=[...V,...qe,...we];let N=null,O=null;function fe(e,t,n){N=e,O=t,console.log(e),console.log(t)}function g(){if(!N)throw new Error("ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“");return N}function v(){if(!O)throw new Error("æ•µãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“");return O}let T;function Ce(e){T=e}function Ne(){return T}let j=1;function Oe(){Ee.style.display="",W.style.display="";const e=k[j],t=ee(e);fe(g(),t),he(),Te(T.skillDiv,V),y(d),T.defaultAttackBtn.style.display="",T.nextStageBtn.style.display="none",T.battleLogArea.style.display="",T.afterBattleLogArea.style.display="none",j++,ge(t)}function ge(e){de(`ç¬¬ ${j} éšå±¤`),f(`${e.name}ãŒç¾ã‚ŒãŸï¼`,"ã©ã†ã™ã‚‹ï¼Ÿ")}const je=document.querySelector(".battle-area"),De=document.getElementById("game-over"),le=document.getElementById("game-reset");function Re(){je.style.display="none",De.style.display="",ze(),le&&le.addEventListener("click",()=>{window.location.href="safezone.html"})}function ze(){const e=g(),t={name:e.name,job:e.className,inventory:e.inventory};localStorage.setItem("saveData",JSON.stringify(t))}let P=1,Y=!1,Z=!1,D=!1,R=!1;function M(){Y=!0,h()}function $e(){Z=!0,h()}function z(){R||(R=!0,h())}function L(){U.style.display!==""&&(ye(),q.style.display="none",x.style.display="none",Y=!1,Z=!1,R=!1,D=!1,r(`--- ${P}ã‚¿ãƒ¼ãƒ³ç›® ---`))}function h(){Y&&Z&&!D&&(D=!0,P++,setTimeout(()=>{x.style.display="",q.style.display="",f(`${P}ã‚¿ãƒ¼ãƒ³ç›®ãŒçµ‚äº†â€¦`,"æ¬¡ã®è¡Œå‹•ã‚’é¸ã¹")},1e3))}function Je(){P=1}function _(e,t=null,n=!1){if(e.hp>0||!n)return;const s=g();let a;if(s instanceof Object&&"inventory"in s)a=s;else return;const{defaultAttackBtn:o,nextStageBtn:l,toggleArea:m,battleLogArea:u,afterBattleLogArea:$,skillDiv:b}=Ne();if(m.style.display="",Ee.style.display="none",b.style.display="none",u.style.display="none",$.style.display="",e.hp=0,console.log(e.name),e.isPlayer)u.style.display="",$.style.display="none",r(`<h1>${e.name} ã¯å€’ã•ã‚ŒãŸ</h1>`,"5ç§’å¾Œã«å¼•ãç¶™ãã‚¢ã‚¤ãƒ†ãƒ é¸æŠç”»é¢ã«ç§»å‹•ã—ã¾ã™"),setTimeout(Re,5e3);else{Ue(o,l,u,$),Je(),de("ã‚»ãƒ¼ãƒ•ãƒ†ã‚£ãƒ¼ã‚¨ãƒªã‚¢");const c=Math.floor(a.maxHp*.2),p=Math.floor(a.maxMp*.2);if(a.hp=Math.min(a.hp+c,a.maxHp),a.mp=Math.min(a.mp+p,a.maxMp),t&&l.style.display==="")ye(),r(`${e.name} ã¯å€’ã•ã‚ŒãŸ`),r("æ¬¡ã®éšå±¤ã¾ã§å®‰å…¨ã ã€‚å›å¾©ãƒ»è£…å‚™ãƒ»ã‚¹ã‚­ãƒ«ã‚’ä½¿ã£ã¦æº–å‚™ã—ã‚ˆã†ã€‚"),r(`å‹åˆ©ãƒœãƒ¼ãƒŠã‚¹ï¼HPãŒ${c}ã€MPãŒ${p}å›å¾©ã—ãŸï¼`,""),pe(a);else if(l.style.display==="none"&&$.style.display==="none")f("å¤–ã«å‡ºã‚ˆã†");else{r(`${e.name} ã¯å€’ã•ã‚ŒãŸ`),r("æ¬¡ã®éšå±¤ã¾ã§å®‰å…¨ã ã€‚å›å¾©ãƒ»è£…å‚™ãƒ»ã‚¹ã‚­ãƒ«ã‚’ä½¿ã£ã¦æº–å‚™ã—ã‚ˆã†ã€‚",""),r(`å‹åˆ©ãƒœãƒ¼ãƒŠã‚¹ï¼HPãŒ${c}ã€MPãŒ${p}å›å¾©ã—ãŸï¼`,""),pe(a);return}y()}}let C=1;function Ue(e,t,n,s){const a=k[C];if(console.log(C,a),C++,a)e.style.display="none",t.style.display="";else{e.style.display="none",t.style.display="none",n.style.display="",s.style.display="none",f("ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã‚¯ãƒªã‚¢ï¼ï¼ğŸ‰","ãŠã‚ã§ã¨ã†ï¼ï¼ï¼");return}}function J(e,t,n){const s=Ae[e],a=g();if(!s){f("ã‚¹ã‚­ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ï¼","");return}const o=t,l=n;if(o.mp<s.mpCost){r(`${o.name}ã¯ã‚¹ã‚­ãƒ«ã‚’ç™ºå‹•ï¼`,`ã—ã‹ã—ã€${o.name} ã¯MPãŒè¶³ã‚Šãªã„ï¼`);return}else o.mp-=s.mpCost;o.mp-=s.mpCost;const m=s.power(o);if(s.type==="heal"?s.log(s.name,o,l||null,s.power(o)):(l.hp-=m,s.log(s.name,o,l,s.power(o)),h()),l.hp>0&&o===a?(M(),B(1e3)):l.hp>0&&($e(),h()),l.hp<=0&&s.type!=="heal"){l.hp=0,y(d),setTimeout(()=>{const u=typeof s.log=="function"?()=>s.log(s.name,o,l,s.power(o)):null;setTimeout(()=>{_(l,u,!0)},1e3)},850);return}h(),y(d)}const ie=document.getElementById("instruction-border"),We=document.getElementById("instruction");function Te(e,t){e.innerText="",t.forEach((n,s)=>{const a=document.createElement("button");a.innerHTML=`${n.name} <br>ï¼ˆæ¶ˆè²»MP:${n.mpCost}ï¼‰`,a.addEventListener("mouseover",()=>{ie.style.display="block",We.innerText=n.Instruction}),a.addEventListener("mouseleave",()=>{ie.style.display="none"}),a.addEventListener("click",()=>{L();const o=g(),l=v();z(),J(s,o,l)}),e.appendChild(a)}),y(d)}function Xe(e){e.addEventListener("click",()=>{L();const t=g(),n=v(),s=Math.max(t.physicalStrength-n.defense,1);if(n.hp-=s,n.hp<=0&&(n.hp=0),r(`${t.name} ã®æ”»æ’ƒï¼${n.name} ã« ${s} ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼`,`(${n.name}ã®HPï¼š${n.hp})`),y(d),n.hp<=0){setTimeout(()=>{_(n,null,!0)},1e3);return}else B(850);y(d),M(),h()})}function Fe(){const e=g();let t;if(e instanceof Object&&"inventory"in e)t=e;else throw new Error("Player ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ");const n=v();let s;if(n instanceof Object)s=n;else throw new Error("Enemy ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ");if(s.hp<=0)return;let a;if(s.hp>=s.maxHp*.7?a=Math.random()<.95?"attack":"heal":s.hp<=s.maxHp*.3?a=Math.random()<.4?"attack":"heal":a=Math.random()<.7?"attack":"heal",a==="attack")if(Math.random()<(s.hp>=s.maxHp*.7?.05:s.hp<=s.maxHp*.3?.5:.3)){const l=Math.floor(Math.random()*100),m=l<50?0:l<80?1:2;J(m,s,t),z()}else{const l=Math.max(s.physicalStrength-t.defense,1);if(t.hp-=l,r(`${s.name} ã®æ”»æ’ƒï¼
 ${t.name} ã¯${l} ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’å—ã‘ãŸï¼`,`(${t.name}ã®HPï¼š${t.hp})`),t.hp<=0){he(),t.hp=0,_(t,null,!0);return}}else J(3,s,t),z();y(d),$e(),h()}function B(e=1e3){setTimeout(()=>{Fe()},e)}class Ke{constructor(t,n,s,a,o,l,m,u){i(this,"name");i(this,"className");i(this,"hp");i(this,"maxHp");i(this,"mp");i(this,"maxMp");i(this,"physicalStrength");i(this,"magicalStrength");i(this,"defense");i(this,"speed");i(this,"isPlayer",!0);i(this,"equipment",[]);i(this,"inventory",[]);this.name=t,this.className=n,this.hp=s,this.maxHp=s,this.mp=a,this.maxMp=a,this.physicalStrength=o,this.magicalStrength=l,this.defense=m,this.speed=u}getPlayerStatus(){return`${this.name}ï¼ˆ${this.className}ï¼‰ï¼šã€HP ${this.hp}/${this.maxHp}ã€‘ã€MP ${this.mp}/${this.maxMp}ã€‘`}healItem(t){if(x.style.display="none",L(),M(),t.itemType==="hpHeal"){const n=t.effect.hp??0;this.hp=Math.min(this.hp+n,this.maxHp),r(`${this.name} ã¯ ${t.name} ã‚’ä½¿ã„ã€HPã‚’${n}å›å¾©ã—ãŸï¼`,"")}else if(t.itemType==="mpHeal"){const n=t.effect.mp??0;this.mp=Math.min(this.mp+n,this.maxMp),r(`${this.name} ã¯ ${t.name} ã‚’ä½¿ã„ã€MPã‚’${n}å›å¾©ã—ãŸï¼`,"")}else if(t.itemType==="bothHeal"){const n=t.effect.hp??0,s=t.effect.mp??0;this.hp=Math.min(this.hp+n,this.maxHp),this.mp=Math.min(this.mp+s,this.maxMp),r(`${this.name} ã¯ ${t.name} ã‚’ä½¿ã„ã€HP${n}ãƒ»MP${s}å›å¾©ã—ãŸï¼`,"")}B(1e3)}equipItem(t){x.style.display="none",L(),M();const n=this.equipment.find(s=>s.equipmentType===t.equipmentType);if(n){this.unequipItem(n);return}this.physicalStrength+=t.effect.physicalStrength||0,this.defense+=t.effect.defense||0,this.speed+=t.effect.speed||0,t.isEquipped=!0,this.equipment.push(t),r(`${t.name} ã‚’è£…å‚™ã—ãŸï¼`),B(1e3)}unequipItem(t){x.style.display="none",L(),M(),this.physicalStrength-=t.effect.physicalStrength||0,this.defense-=t.effect.defense||0,t.isEquipped=!1;const n=this.equipment.indexOf(t);n!==-1&&this.equipment.splice(n,1);const s=this.inventory.find(a=>a.name===t.name);s?s.amount+=1:this.inventory.push(new ne(t.name,t.itemType,t.equipmentType,t.effect,1,t.rarity,t.instructionText)),r(`${t.name} ã‚’å¤–ã—ã€ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªã«æˆ»ã—ãŸ`),B(1e3)}}class Ge{constructor(t,n,s,a,o,l,m,u){i(this,"name");i(this,"className");i(this,"hp");i(this,"maxHp");i(this,"mp");i(this,"maxMp");i(this,"physicalStrength");i(this,"magicalStrength");i(this,"defense");i(this,"speed");i(this,"isPlayer",!1);this.name=t,this.className=n,this.hp=s,this.maxHp=s,this.mp=a,this.maxMp=a,this.physicalStrength=o,this.magicalStrength=l,this.defense=m,this.speed=u}getEnemyStatus(){return`${this.name}ï¼ˆ${this.className}ï¼‰ï¼šã€HP ${this.hp}/${this.maxHp}ã€‘ã€MP ${this.mp}/${this.maxMp}ã€‘`}}function Qe(e,t){const n=ke[e];return new Ke(t,n.className,n.hp,n.mp,n.physicalStrength,n.magicalStrength,n.defense,n.speed)}function ee(e){return new Ge(e.name,e.className,e.hp,e.mp,e.physicalStrength,e.magicalStrength,e.defense,e.hitRate??80)}function Ve(){[{btnId:"toggle-heal-items",listId:"heal-items",label:"å›å¾©ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§"},{btnId:"toggle-equip-items",listId:"equip-items",label:"è£…å‚™ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§"},{btnId:"toggle-skill-list",listId:"skill-list",label:"ã‚¹ã‚­ãƒ«ä¸€è¦§"},{btnId:"background-button",listId:"background-area",label:"ãƒãƒˆãƒ«ãƒ­ã‚°å±¥æ­´"}].forEach(({btnId:t,listId:n,label:s})=>{const a=document.getElementById(t),o=document.getElementById(n);a.textContent=`â–¶ï¸ ${s}`,o.classList.add("hidden"),a.addEventListener("click",()=>{const l=o.classList.toggle("hidden");a.textContent=l?`â–¶ï¸ ${s}`:`â–¼ ${s}ã‚’é–‰ã˜ã‚‹`})})}function Ye(e,t){e.addEventListener("click",()=>{q.style.display="",t()})}const re=document.querySelector(".battle-area"),q=document.getElementById("toggle-area");document.getElementById("toggle-heal-items");document.getElementById("toggle-equip-items");const Ee=document.getElementById("toggle-skill-list"),ce=document.getElementById("battle-log"),me=document.getElementById("after-battle-log"),Ze=document.getElementById("player-status"),x=document.getElementById("default-attack"),U=document.getElementById("next-stage"),_e=document.getElementById("enemy-status"),et=document.getElementById("equipped-items"),W=document.getElementById("skill-list"),tt=document.getElementById("heal-items"),nt=document.getElementById("equip-items"),d={playerStatus:Ze,enemyStatus:_e,healItemsDiv:tt,equipItemsDiv:nt,equippedDiv:et};function st(){re.style.display="",Pe({battleLog:ce,afterBattleLog:me});const e=k[0],t=ee(e);ge(t),Te(W,V),Xe(x),Ve(),Ye(U,Oe),Ce({defaultAttackBtn:x,nextStageBtn:U,battleArea:re,toggleArea:q,battleLogArea:ce,afterBattleLogArea:me,skillDiv:W,uiElements:d}),y(d)}document.addEventListener("DOMContentLoaded",()=>{const e=localStorage.getItem("playerData"),t=location.pathname.includes("safezone.html");if(!e&&!t){alert("ã‚»ãƒ¼ãƒ•ãƒ†ã‚£ã‚¨ãƒªã‚¢ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¦ãã ã•ã„ï¼"),window.location.href="safezone.html";return}if(e){const n=JSON.parse(e);at(n)}});function at(e){const t=Qe(e.jobIndex,e.name),n=[...e.equipment.map(a=>new ne(a.name,a.itemType,a.equipmentType??"",a.effect,a.amount??1,a.rarity,a.instructionText)),...e.items.map(a=>new xe(a.name,a.itemType,a.effect,a.amount??1,a.rarity,a.instructionText))];t.inventory=n;const s=ee(k[0]);fe(t,s),st()}const ot=[{name:"HPã®å®Ÿ",itemType:"hpHeal",effect:{hp:30},amount:0,rarity:"common",instructionText:"ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼šä¸€èˆ¬ç´šã€‚HPã‚’30å›å¾©ã™ã‚‹ã€‚"},{name:"HPã‚¸ãƒ£ãƒ ",itemType:"hpHeal",effect:{hp:80},amount:0,rarity:"uncommon",instructionText:"ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼šå¸Œå°‘ç´šã€‚HPã‚’80å›å¾©ã™ã‚‹ã€‚"},{name:"HPãƒãƒ¼ã‚·ãƒ§ãƒ³",itemType:"hpHeal",effect:{hp:200},amount:0,rarity:"rare",instructionText:"ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼šä¸Šç´šã€‚HPã‚’200å›å¾©ã™ã‚‹ã€‚"},{name:"MPã®å®Ÿ",itemType:"mpHeal",effect:{mp:10},amount:0,rarity:"common",instructionText:"ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼šä¸€èˆ¬ç´šã€‚MPã‚’10å›å¾©ã™ã‚‹ã€‚"},{name:"MPã‚¸ãƒ£ãƒ ",itemType:"mpHeal",effect:{mp:30},amount:0,rarity:"uncommon",instructionText:"ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼šå¸Œå°‘ç´šã€‚MPã‚’30å›å¾©ã™ã‚‹ã€‚"},{name:"MPãƒãƒ¼ã‚·ãƒ§ãƒ³",itemType:"mpHeal",effect:{mp:60},amount:0,rarity:"rare",instructionText:"ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼šä¸Šç´šã€‚MPã‚’60å›å¾©ã™ã‚‹ã€‚"},{name:"ã‚¨ãƒªã‚¯ã‚µãƒ¼",itemType:"bothHeal",effect:{hp:500,mp:500},amount:0,rarity:"legendary",instructionText:"ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼šä¼èª¬ç´šã€‚MPã‚’500å›å¾©ã™ã‚‹ã€‚"}],lt=[{name:"æœ¨ã®æ£’",itemType:"equipment",equipmentType:"sword",effect:{physicalStrength:5},amount:0,rarity:"common",instructionText:"åˆ†é¡ï¼šå‰£ã€‚ ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼šä¸€èˆ¬ã€‚ æ”»æ’ƒåŠ›ï¼‹ï¼•"},{name:"æ¬ ã‘ãŸé‰„é§",itemType:"equipment",equipmentType:"armor",effect:{defense:8,speed:-3},amount:0,rarity:"rare",instructionText:"åˆ†é¡ï¼šé§ã€‚ ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼šä¸Šç´šã€‚ é˜²å¾¡åŠ›ï¼‹ï¼˜ã€ã‚¹ãƒ”ãƒ¼ãƒ‰âˆ’ï¼“"},{name:"ãƒã‚²ãŸå…œ",itemType:"equipment",equipmentType:"helmet",effect:{defense:4},amount:0,rarity:"uncommon",instructionText:"åˆ†é¡ï¼šå…œã€‚ ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼šå¸Œå°‘ç´šã€‚ é˜²å¾¡åŠ›ï¼‹ï¼”"},{name:"ç©´ã®ç©ºã„ãŸé©é´",itemType:"equipment",equipmentType:"shoes",effect:{defense:2,speed:5},amount:0,rarity:"common",instructionText:"åˆ†é¡ï¼šé´ã€‚ ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼šä¸€èˆ¬ç´šã€‚ é˜²å¾¡åŠ›ï¼‹ï¼”"},{name:"å¼¦ãŒåˆ‡ã‚Œãã†ãªå¼“",itemType:"equipment",equipmentType:"bow",effect:{physicalStrength:10,hitRate:-5},amount:0,rarity:"rare",instructionText:"åˆ†é¡ï¼šå‰£ã€‚ ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼šä¸Šç´šã€‚ æ”»æ’ƒåŠ›ï¼‹50ã€‚"},{name:"ã‚¨ã‚¯ã‚¹ã‚«ãƒªãƒãƒ¼",itemType:"equipment",equipmentType:"sword",effect:{physicalStrength:50},amount:0,rarity:"legendary",instructionText:"åˆ†é¡ï¼šå‰£ã€‚ ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼šä¼èª¬ç´šã€‚ æ”»æ’ƒåŠ›ï¼‹50ã€‚"}];class te{constructor(t,n,s,a,o,l){i(this,"name");i(this,"itemType");i(this,"effect");i(this,"amount");i(this,"rarity");i(this,"instructionText");i(this,"isEquipped",!1);this.name=t,this.itemType=n,this.effect=s,this.amount=a,this.rarity=o,this.instructionText=l}showAmount(){return`${this.name}ï¼š${this.amount} å€‹`}}class xe extends te{}class ne extends te{constructor(n,s,a,o,l,m,u){super(n,s,o,l,m,u);i(this,"equipmentType");this.equipmentType=a,this.isEquipped=!1}}const se=ot.map(e=>new xe(e.name,e.itemType,e.effect,e.amount,e.rarity,e.instructionText)),ae=lt.map(e=>new ne(e.name,e.itemType,e.equipmentType??null,e.effect,e.amount,e.rarity,e.instructionText)),it=[...se,...ae];function rt(e,t){const n=t.reduce((o,l)=>o+l,0),s=Math.random()*n;let a=0;for(let o=0;o<e.length;o++)if(a+=t[o],s<a)return e[o];return e[e.length-1]}function pe(e){const t=it,n={common:.6,uncommon:.3,rare:.15,epic:.05,legendary:.02},s=t.map(l=>n[l.rarity]||.6),a=rt(t,s);console.log("ã€DEBUGã€‘é¸ã°ã‚ŒãŸdroppedItemï¼š",a);const o=e.inventory.find(l=>l.name===a.name);o?o.amount+=1:e.inventory.push(new te(a.name,a.itemType,a.effect,1,a.rarity,a.instructionText)),f(`ãƒ‰ãƒ­ãƒƒãƒ—å ±é…¬ï¼š${a.name}ï¼ˆ${a.rarity}ï¼‰ã‚’æ‰‹ã«å…¥ã‚ŒãŸï¼`,""),y(d)}const w=document.getElementById("lobby"),X=document.getElementById("select-player-area"),F=document.getElementById("shop-area"),He=document.getElementById("cooking-area"),ct=document.getElementById("cooking-btn"),mt=document.querySelectorAll(".safety-area-btn"),pt=document.getElementById("shop-btn"),ut=document.getElementById("prepare-battle-btn");ut.addEventListener("click",()=>{console.log(X),w.style.display="none",X.style.display="block"});mt.forEach(e=>{e.addEventListener("click",()=>{w.style.display="block",X.style.display="none",F.style.display="none",He.style.display="none"})});pt.addEventListener("click",()=>{F.style.display="block",w.style.display="none",console.log(F)});ct.addEventListener("click",()=>{w.style.display="none",He.style.display="block"});document.getElementById("start-button-buttle").addEventListener("click",()=>{const e=document.getElementById("player-name-input").value.trim(),t=oe;if(!e||!t){alert("åå‰ã¨è·æ¥­ã¯å¿…é ˆã§ã™ï¼");return}const n=Ie.map(o=>({...ae[o],amount:1})),s=Me.map(o=>({...se[o],amount:1})),a={name:e,job:t,jobIndex:t==="æˆ¦å£«"?0:1,equipment:n,items:s};localStorage.setItem("playerData",JSON.stringify(a)),window.location.href="battleDisplay.html"});let oe=null;const K=document.getElementById("select-warrior"),G=document.getElementById("select-mage");K.addEventListener("click",()=>{oe="æˆ¦å£«",Se(K,G)});G.addEventListener("click",()=>{oe="é­”æ³•ä½¿ã„",Se(G,K)});function Se(e,t){e.classList.add("selected-class"),t.classList.remove("selected-class")}const Ie=[],Me=[],dt=document.getElementById("equipment-options"),yt=document.getElementById("heal-item-options"),ht=ae.filter(e=>e.rarity==="common"),ft=se.filter(e=>e.rarity==="common");Le(ht,dt,Ie,2);Le(ft,yt,Me,2);function Le(e,t,n,s){e.forEach((a,o)=>{const l=document.createElement("button");l.textContent=a.name,l.addEventListener("click",()=>{const m=n.indexOf(o);if(m!==-1)n.splice(m,1),l.classList.remove("selected-class");else{if(n.length>=s){alert(`æœ€å¤§${s}ã¤ã¾ã§é¸ã¹ã¾ã™`);return}n.push(o),l.classList.add("selected-class")}}),t.appendChild(l)})}
